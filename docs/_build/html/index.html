

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to prot_brnn’s documentation! &mdash; prot_brnn  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> prot_brnn
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">prot_brnn API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#driving-scripts">Driving scripts:</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#modules">Modules:</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/quickstart.html">Quickstart yo! This is what is up!</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">prot_brnn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to prot_brnn’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-prot-brnn-s-documentation">
<h1>Welcome to prot_brnn’s documentation!<a class="headerlink" href="#welcome-to-prot-brnn-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">prot_brnn API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#driving-scripts">Driving scripts:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#brnn-train">brnn_train</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#brnn-predict">brnn_predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#brnn-optimize">brnn_optimize</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html#modules">Modules:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-prot_brnn.brnn_architecture">brnn_architecture.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-prot_brnn.encode_sequence">encode_sequence.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-prot_brnn.process_input_data">process_input_data.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-prot_brnn.train_network">train_network.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-prot_brnn.bayesian_optimization">bayesian_optimization.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-prot_brnn.brnn_plot">brnn_plot.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/quickstart.html">Quickstart yo! This is what is up!</a></li>
</ul>
</div>
<span class="target" id="module-prot_brnn.train_network"></span><p>The core training module of the project</p>
<dl class="py function">
<dt id="prot_brnn.train_network.test_labeled_data">
<code class="sig-prename descclassname">prot_brnn.train_network.</code><code class="sig-name descname">test_labeled_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">test_loader</span></em>, <em class="sig-param"><span class="n">datatype</span></em>, <em class="sig-param"><span class="n">problem_type</span></em>, <em class="sig-param"><span class="n">weights_file</span></em>, <em class="sig-param"><span class="n">num_classes</span></em>, <em class="sig-param"><span class="n">device</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prot_brnn/train_network.html#test_labeled_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prot_brnn.train_network.test_labeled_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Test a trained BRNN on labeled sequences</p>
<p>Using the saved weights of a trained network, run a set of sequences through
the network and evaluate the performancd. Return the average loss per
sequence and plot the results. Testing a network on previously-unseen data
provides a useful estimate of how generalizeable the network’s performance is.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>PyTorch network object</em>) – A BRNN network with the desired architecture</p></li>
<li><p><strong>test_loader</strong> (<em>PyTorch DataLoader object</em>) – A DataLoader containing the sequences and targets of the test set</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – The format of values in the dataset. Should be ‘sequence’ for datasets
with a single value (or class label) per sequence, or ‘residues’ for
datasets with values (or class labels) for every residue in a sequence.</p></li>
<li><p><strong>problem_type</strong> (<em>str</em>) – The machine learning task–should be either ‘regression’ or
‘classification’.</p></li>
<li><p><strong>weights_file</strong> (<em>str</em>) – A path to the location of the best_performing network weights</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of data classes. If regression task, put 1.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Location of where testing will take place–should be either ‘cpu’ or
‘cuda’ (GPU). If available, training on GPU is typically much faster.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average loss across the entire test set</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="prot_brnn.train_network.test_unlabeled_data">
<code class="sig-prename descclassname">prot_brnn.train_network.</code><code class="sig-name descname">test_unlabeled_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">sequences</span></em>, <em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">encoding_scheme</span><span class="o">=</span><span class="default_value">'onehot'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prot_brnn/train_network.html#test_unlabeled_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prot_brnn.train_network.test_unlabeled_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Test a trained BRNN on unlabeled sequences</p>
<p>Use a trained network to make predictions on previously-unseen data.</p>
<p>** Note: Unlike the previous functions, <cite>network</cite> here must have pre-loaded
weights. **</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>PyTorch network object</em>) – A BRNN network with the desired architecture and pre-loaded weights</p></li>
<li><p><strong>sequences</strong> (<em>list</em>) – A list of amino acid sequences to test using the network</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Location of where testing will take place–should be either ‘cpu’ or
‘cuda’ (GPU). If available, training on GPU is typically much faster.</p></li>
<li><p><strong>encoding_scheme</strong> (<em>str</em>) – How amino acid sequences are to be encoded as numeric vectors. Currently,
‘onehot’ and ‘biophysics’ are the implemented options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary containing predictions mapped to sequences</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="prot_brnn.train_network.train">
<code class="sig-prename descclassname">prot_brnn.train_network.</code><code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">train_loader</span></em>, <em class="sig-param"><span class="n">val_loader</span></em>, <em class="sig-param"><span class="n">datatype</span></em>, <em class="sig-param"><span class="n">problem_type</span></em>, <em class="sig-param"><span class="n">weights_file</span></em>, <em class="sig-param"><span class="n">stop_condition</span></em>, <em class="sig-param"><span class="n">device</span></em>, <em class="sig-param"><span class="n">learn_rate</span></em>, <em class="sig-param"><span class="n">n_epochs</span></em>, <em class="sig-param"><span class="n">verbosity</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prot_brnn/train_network.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prot_brnn.train_network.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a BRNN and save the best performing network weights</p>
<p>Train the network on a training set, and every epoch evaluate its performance on
a validation set. Save the network weights that acheive the best performance on
the validation set.</p>
<p>User must specify the machine learning tast (<cite>problem_type</cite>) and the format of
the data (<cite>datatype</cite>). Additionally, this function requires the learning rate
hyperparameter and the number of epochs of training. The other hyperparameters,
number of hidden layers and hidden vector size, are implictly included on the
the provided network.</p>
<p>The user may specify if they want to train the network for a set number of
epochs or until an automatic stopping condition is reached with the argument
<cite>stop_condition</cite>. Depending on the stopping condition used, the <cite>n_epochs</cite>
argument will have a different role.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>PyTorch network object</em>) – A BRNN network with the desired architecture</p></li>
<li><p><strong>train_loader</strong> (<em>PyTorch DataLoader object</em>) – A DataLoader containing the sequences and targets of the training set</p></li>
<li><p><strong>val_loader</strong> (<em>PyTorch DataLoader object</em>) – A DataLoader containing the sequences and targets of the validation set</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – The format of values in the dataset. Should be ‘sequence’ for datasets
with a single value (or class label) per sequence, or ‘residues’ for
datasets with values (or class labels) for every residue in a sequence.</p></li>
<li><p><strong>problem_type</strong> (<em>str</em>) – The machine learning task–should be either ‘regression’ or
‘classification’.</p></li>
<li><p><strong>weights_file</strong> (<em>str</em>) – A path to the location where the best_performing network weights will be
saved</p></li>
<li><p><strong>stop_condition</strong> (<em>str</em>) – Determines when to conclude network training. If ‘iter’, then the network
will train for <cite>n_epochs</cite> epochs, then stop. If ‘auto’ then the network
will train for at least <cite>n_epochs</cite> epochs, then begin assessing whether
performance has sufficiently stagnated. If the performance plateaus for
<cite>n_epochs</cite> consecutive epochs, then training will stop.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Location of where training will take place–should be either ‘cpu’ or
‘cuda’ (GPU). If available, training on GPU is typically much faster.</p></li>
<li><p><strong>learn_rate</strong> (<em>float</em>) – Initial learning rate of network training. The training process is
controlled by the Adam optimization algorithm, so this learning rate
will tend to decrease as training progresses.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs to train for, or required to have stagnated performance
for, depending on <cite>stop_condition</cite>.</p></li>
<li><p><strong>verbosity</strong> (<em>int, optional</em>) – The degree to which training updates are written to standard out (default
is 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list</em> – A list of the average training set losses achieved at each epoch</p></li>
<li><p><em>list</em> – A list of the average validation set losses achieved at each epoch</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="getting_started.html" class="btn btn-neutral float-right" title="Getting Started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Holehouse Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.3

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>